{% extends 'desaapp/base.html' %}
{% load static %}

{% block title %}Galeri Desa{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'desaapp/css/gallery.css' %}">
{% endblock %}

{% block content %}
<!-- Header -->
<section class="profile-header">
  <div class="container text-center">
    <h1>Galeri Desa Sidomulyo</h1>
    <p>Dokumentasi kegiatan, pembangunan, UMKM, budaya, dan keindahan Desa Sidomulyo dalam foto maupun video</p>
  </div>
</section>

<div class="container">

  <!-- Filter Kategori -->
  <div class="category-filter">
    <span>Filter kategori:</span>
    {% for cat in categories %}
      <a href="?category={{ cat }}" class="btn {% if active_category == cat %}active{% endif %}">
        {{ cat }}
      </a>
    {% endfor %}
  </div>

  <!-- Daftar Galeri -->
  <div class="gallery-grid">
    {% for item in galleries %}
      <div class="gallery-card">

        <!-- Thumbnail -->
        <div class="gallery-thumb">
          {% if item.video_file or item.video_url %}
            <video muted autoplay loop playsinline>
              <source src="{% if item.video_file %}{{ item.video_file.url }}{% else %}{{ item.video_url }}{% endif %}" type="video/mp4">
            </video>
            <span class="badge video">Video</span>
          {% elif item.images.exists %}
            <img src="{{ item.images.first.image.url }}" alt="{{ item.title }}">
            <span class="badge photo">Foto</span>
          {% else %}
            <img src="{{ item.thumbnail.url }}" alt="{{ item.title }}">
            <span class="badge photo">Foto</span>
          {% endif %}
        </div>

        <!-- Info -->
        <div class="gallery-body">
          <h3>{{ item.title }}</h3>
          <p class="desc">{{ item.description|truncatewords:18 }}</p>
          <div class="meta">
            <span><i class="fa-regular fa-calendar"></i> {{ item.date }}</span>
            <span><i class="fa-solid fa-tags"></i> {{ item.category }}</span>
            <span><i class="fa-regular fa-eye"></i> {{ item.views }} views</span>
          </div>
        </div>

        <!-- Footer -->
        <div class="back-link">
          <a href="{% url 'gallery_detail' item.pk %}" class="btn-detail">Lihat Detail â†’</a>
        </div>

      </div>
    {% empty %}
      <p class="text-center">Belum ada konten untuk kategori "{{ active_category }}"</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
